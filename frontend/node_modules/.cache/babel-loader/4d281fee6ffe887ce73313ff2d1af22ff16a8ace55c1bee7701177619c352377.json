{"ast":null,"code":"var _jsxFileName = \"/Users/fitzpatrickcarl/Documents/project-root/frontend/src/Components/Score.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport VexFlow from 'vexflow';\nimport { debounce } from 'lodash'; // Assuming you have lodash installed for debouncing\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VF = VexFlow.Flow;\nconst {\n  Renderer,\n  Stave,\n  StaveNote,\n  Formatter\n} = VF;\nconst clefAndTimeWidth = 60;\nexport function Score({\n  staves = [],\n  clef = 'treble',\n  timeSignature = '4/4'\n}) {\n  _s();\n  const container = useRef();\n  const rendererRef = useRef();\n  const [dimensions, setDimensions] = useState({\n    width: 1500,\n    height: 150\n  }); // Initial dimensions\n\n  useEffect(() => {\n    // Debounce the resize function\n    const handleResize = debounce(() => {\n      if (container.current) {\n        setDimensions({\n          width: container.current.offsetWidth,\n          height: container.current.offsetHeight\n        });\n      }\n    }, 100);\n    window.addEventListener('resize', handleResize);\n\n    // Call handleResize initially to set the initial size based on the container\n    handleResize();\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n  useEffect(() => {\n    if (!container.current) return;\n    const initializeRenderer = () => {\n      rendererRef.current = new Renderer(container.current, Renderer.Backends.SVG);\n    };\n    if (!rendererRef.current) {\n      initializeRenderer();\n    }\n    const renderer = rendererRef.current;\n    renderer.resize(dimensions.width, dimensions.height);\n    const context = renderer.getContext();\n    context.setFont('Arial', 10, '').setBackgroundFillStyle('#eed');\n    const staveWidth = (dimensions.width - clefAndTimeWidth) / staves.length;\n    let currX = 0;\n    staves.forEach((notes, i) => {\n      const stave = new Stave(currX, 0, staveWidth);\n      if (i === 0) {\n        stave.setWidth(staveWidth + clefAndTimeWidth);\n        stave.addClef(clef).addTimeSignature(timeSignature);\n      }\n      currX += stave.getWidth();\n      stave.setContext(context).draw();\n      const processedNotes = notes.map(note => typeof note === 'string' ? {\n        key: note\n      } : Array.isArray(note) ? {\n        key: note[0],\n        duration: note[1]\n      } : note).map(({\n        key,\n        ...rest\n      }) => typeof key === 'string' ? {\n        key: key.includes('/') ? key : `${key[0]}/${key.slice(1)}`,\n        ...rest\n      } : rest).map(({\n        key,\n        keys,\n        duration = 'q'\n      }) => new StaveNote({\n        keys: key ? [key] : keys,\n        duration: String(duration)\n      }));\n      Formatter.FormatAndDraw(context, stave, processedNotes, {\n        auto_beam: true\n      });\n    });\n  }, [staves, clef, timeSignature, dimensions]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: container,\n    style: {\n      width: '100%',\n      height: '100%'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 10\n  }, this);\n}\n_s(Score, \"sgbRTqWiQxF+4lcB+64l1FpmfUk=\");\n_c = Score;\nvar _c;\n$RefreshReg$(_c, \"Score\");","map":{"version":3,"names":["React","useRef","useEffect","useState","VexFlow","debounce","jsxDEV","_jsxDEV","VF","Flow","Renderer","Stave","StaveNote","Formatter","clefAndTimeWidth","Score","staves","clef","timeSignature","_s","container","rendererRef","dimensions","setDimensions","width","height","handleResize","current","offsetWidth","offsetHeight","window","addEventListener","removeEventListener","initializeRenderer","Backends","SVG","renderer","resize","context","getContext","setFont","setBackgroundFillStyle","staveWidth","length","currX","forEach","notes","i","stave","setWidth","addClef","addTimeSignature","getWidth","setContext","draw","processedNotes","map","note","key","Array","isArray","duration","rest","includes","slice","keys","String","FormatAndDraw","auto_beam","ref","style","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/fitzpatrickcarl/Documents/project-root/frontend/src/Components/Score.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport VexFlow from 'vexflow';\nimport { debounce } from 'lodash'; // Assuming you have lodash installed for debouncing\n\nconst VF = VexFlow.Flow;\nconst { Renderer, Stave, StaveNote, Formatter } = VF;\n\nconst clefAndTimeWidth = 60;\n\nexport function Score({ staves = [], clef = 'treble', timeSignature = '4/4' }) {\n  const container = useRef();\n  const rendererRef = useRef();\n  const [dimensions, setDimensions] = useState({ width: 1500, height: 150 }); // Initial dimensions\n\n  useEffect(() => {\n    // Debounce the resize function\n    const handleResize = debounce(() => {\n      if (container.current) {\n        setDimensions({\n          width: container.current.offsetWidth,\n          height: container.current.offsetHeight,\n        });\n      }\n    }, 100);\n\n    window.addEventListener('resize', handleResize);\n\n    // Call handleResize initially to set the initial size based on the container\n    handleResize();\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!container.current) return;\n\n    const initializeRenderer = () => {\n      rendererRef.current = new Renderer(container.current, Renderer.Backends.SVG);\n    };\n\n    if (!rendererRef.current) {\n      initializeRenderer();\n    }\n\n    const renderer = rendererRef.current;\n    renderer.resize(dimensions.width, dimensions.height);\n\n    const context = renderer.getContext();\n    context.setFont('Arial', 10, '').setBackgroundFillStyle('#eed');\n\n    const staveWidth = (dimensions.width - clefAndTimeWidth) / staves.length;\n    let currX = 0;\n\n    staves.forEach((notes, i) => {\n      const stave = new Stave(currX, 0, staveWidth);\n\n      if (i === 0) {\n        stave.setWidth(staveWidth + clefAndTimeWidth);\n        stave.addClef(clef).addTimeSignature(timeSignature);\n      }\n\n      currX += stave.getWidth();\n      stave.setContext(context).draw();\n\n      const processedNotes = notes.map(note => (\n        typeof note === 'string' ? { key: note } : (Array.isArray(note) ? { key: note[0], duration: note[1] } : note)\n      )).map(({ key, ...rest }) => (\n        typeof key === 'string' ? { key: key.includes('/') ? key : `${key[0]}/${key.slice(1)}`, ...rest } : rest\n      )).map(({ key, keys, duration = 'q' }) => (\n        new StaveNote({\n          keys: key ? [key] : keys,\n          duration: String(duration),\n        })\n      ));\n\n      Formatter.FormatAndDraw(context, stave, processedNotes, { auto_beam: true });\n    });\n  }, [staves, clef, timeSignature, dimensions]);\n\n  return <div ref={container} style={{ width: '100%', height: '100%' }} />;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}